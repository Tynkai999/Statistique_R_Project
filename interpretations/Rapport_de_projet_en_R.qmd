---
title: "Rapport de projet de statistique descriptive et inférentielle utilisant le langage R"
format:
  pdf:
    toc: true
    number-sections: true
    colorlinks: true
---
# ***Exercice 1*** : 
### Calculer la moyenne et la variance d'une série statistique des données entrées par un utilisateur

- Première du code : 
  - On demande à l'utilisateur de saisir l'éffectif de la série statiqtique
  - On initialise un vecteur 'numeric' de la longueur spécifiée
  - On demande de saisir les différents éléments de la série statistique
  

![](images/code_1.png)

### Resultat de la première partie du code

![](images/code_2.png)


- Seconde partie du code : 

  - On calcul la moyenne de la série puis on l'affiche
  - On calcul la variance de l'echantillon ()


![](images/code_3.png)

### Résultat du code
![](images/code_4.png)


# ***Exercice 2 : Influence de l'alcool sur le temps de réaction au volant***

```{r}
#| warning: true
#| 
# Les données
# Le vecteur sans_alcool
sans_alcool <- c(0.68, 0.64, 0.68, 0.82, 0.58, 0.80, 0.72, 0.65, 0.84, 0.73, 
                 0.65, 0.59, 0.78, 0.67, 0.65)
# Le vecteur avec_vecteur
avec_alcool <- c(0.73, 0.62, 0.66, 0.92, 0.68, 0.87, 0.77, 0.70, 0.88, 0.79, 
                 0.72, 0.60, 0.78, 0.66, 0.68)

ecdf_sans_alcool <- ecdf(sans_alcool)
ecdf_avec_alcool <- ecdf(avec_alcool)

ecdf_sans_alcool
ecdf_avec_alcool
```
  
## Fonction de repartition empirique
  
  1.  Tracer de la fonction de repartition empirique correspondant aux deux 
      situations (utilisation de simple plot())


```{r}
#Tracer les fonctions de répartitions
#temps de reaction sans consommation d'alcool
plot(ecdf_sans_alcool, main = "Fonctions de répartition empirique", 
     col = "orange", lwd = 2)

#temps de consommation sans alcool
lines(ecdf_avec_alcool, ,col = "red", lwd = 2)

#afficher une legende
legend("bottomright", legend = c("Sans alcool", "Avec alcool"),
col = c("orange", "red"), lwd = 2) 
```

  2. Tracer de la fonction de repartition empirique correspondant aux deux 
      situations (utilisation de simple ggplot2())

![](images/Rplot.png)



## Test d'hypothèse pour comparer les deux groupes

Il s'agit de montrer l'influence de l'alcool sur le temps de réaction au 
seuil de risque $\alpha$ = 5% soit un seuil de confiance de 95%. 
Pour ce faire on utilisera le test de student car les données sont distribuées 
dans chaque groupe.
    
1. Formulation des hypothèses
  
- Hypothèse nulle ($H_0$) pour p-value > 0.05 : Les caractères sont normalement 
distribués (l'alcool n'a pas d'influence sur le temps de réaction.)

- Hypothèse alternative($H_1$) pour p-value < 0.05 : Les caractères ne sont pas 
normalement distribués (l'alcool à une influence sur le temps de réction.)

2. Il s'agit de déterminer le risque à prendre pour tirer une conclusion érroné
soit $\alpha$ = 0.05

3. Vérification des données

```{r}
# Vérification de la normalité
shapiro_sans_alcool <- shapiro.test(sans_alcool)
shapiro_avec_alcool <- shapiro.test(avec_alcool)

cat("Le taux de normalité pour le groupe sans alcool")
shapiro_sans_alcool

cat("Le taux de normalité pour le groupe avec alcool")
shapiro_avec_alcool
``` 

Le test de Shapiro-Wilk montre que les deux groupes _avec alcoool_ et _sans alcool_
suivent une distribution normale (p > 0.05).
Par conséquent l'hypothèse de normalité est respecté pour les deux échantillons.

4. Test d'égalité des variances : Déterminer s'il y'a une différence significative
entre les variance.

```{r}
var_test <- var.test(sans_alcool, avec_alcool)
cat("Test dégalité des variance")
print(var_test)
```


Dans notre cas on p-value (0.5139 > 0.05), il indique qu'il n'y a pas de différence
significative entre les deux variances. 
On peut donc supposer l'egalité des variances entre les deux groupes.


5. Test de student 

```{r}

# Test de student pour les échantillons indépendants
test_t <- t.test(avec_alcool, sans_alcool, var.equal = TRUE)
cat("Test de student pour les échantillons")
print(test_t)

```
***Résultat du test de student :***

* Statistique t : **1.1923**
* Dégré de liberté (n - 2) : **28**
* p-value : **0.2432**
* Intervalle de confiance à 95% : **[-0.02776448 ; 0.10509781]**
* Moyenne du groupe sans alcool : **0.7373333**
* Moyenne du groupe avec alcool : **0.6986667**

Les tests préliminaires de Shapiro–Wilk ont confirmé la normalité des 
distributions dans les deux groupes (p > 0.05), et le test de Fisher a 
indiqué l’égalité des variances (p > 0.05).
Le test t de Student pour échantillons indépendants 
(t = 1.1923, df = 28, p = 0.2432) ne montre aucune différence significative 
entre les moyennes du groupe avec alcool ($M_{\text{avec alcool}} = 0.6986667$) 
et du groupe sans alcool ($M_{\text{sans alcool}} = 0.7373333$).
Ainsi, la consommation d’alcool ne semble pas avoir d’effet significatif sur 
la variable mesurée dans cet échantillon.

Par conséquent l'hypothèse $H_0$ est vérifié. L'alcool n'a pas d'influence 
significative sur le temps de réaction.


# Exercice 3 : Analyse de données pour enfant

1. Création des vecteur

```{r}
# Création des vecteurs

#vecteurs individus
Individus = c("Erika", "Célia", "Erik", "Eve", "Paul", "jean", "Adan", "Louis",
              "Jules", "Léo")
 
#vecteurs Poids
Poids = c(16, 14, 13.5, 15.4, 16.5, 16, 17, 14.8, 17, 16.7)

#vecteurs Taille
Taille = c(100.0, 97.0, 95.5, 101.0, 100.0, 98.5, 103.0, 98.0, 101.5, 100.0)
 
#vecteurs sexe
Sexe = c("F", "F", "G","F","G", "G", "G", "G", "G", "G")
```

1.1. Vecteur pour calculer l'âge des individus
```{r}
# Vecteur An
An <- c(3, 3, 3, 4, 3, 4, 3, 3, 4, 3)
# length(An)
# Vecteur Mois

Mois <- c(5, 10, 5, 0, 8, 0, 11, 9, 1, 3)
# length(Mois)
# Calculer l'âge des individus

Age <- round(An + Mois/12, 1)
Age
```

2. La moyenne des variables (variables quantitatives)

```{r}
#moyenne de la taille
moyenne_taille <- mean(Taille)
moyenne_poids <- mean(Poids)
moyenne_age <- mean(Age)

# Affichage des moyennes
cat("La moyenne des tailles : ", moyenne_taille, "cm\n")
cat("La moyenne des poids : ", moyenne_poids, "kg\n")
cat("La moyenne des âges : ", moyenne_age, "an(s)\n")

```


3. Calcul de l'indice de masse corporelle (IMC)

```{r}
# Taille en mètre
taille_m <- Taille / 100

# Calcul de l'IMC
IMC_echantillon = round((Poids / (taille_m)^2), 2)
# IMC_echantillon

cat("Valeur de l'IMC: \n")
for (i in 1:length(Individus)) {
  cat(Individus[i], " : " ,IMC_echantillon[i], "kg/m²\n")
}

```


4. Structure en dataframe

```{r}
enfant_df <- data.frame(
  Individus = Individus, 
  Sexe = Sexe, 
  Poids = Poids, 
  Taille = Taille,
  Age_complet = Age, 
  IMC_echantillon = IMC_echantillon
)

enfant_df
```





